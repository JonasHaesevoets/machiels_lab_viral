---
title: "Heatmaps_Abseq"
format: 
  html:
    code-fold: true
editor: visual
toc: true
execute:
  warning: false
  message: false
---

## Info on the marker genes

SiglecF: expressed on surface of alveoloar macrophages where it works as a receptor for sialic acid

CD11c: integrin expressed on alveolar macrophages and involved in complement pw as a complement receptor aka itgax

CD274: constituvely expressed on alveolar macrophages =\> possessing a superior phagocytic ability and the capacity to repress cytotoxic T lymphocytes (CTLs) by cis- and trans-interacting with CD80 and PD-1)

H2-IA-IE: aka H2-Ab1 These class II molecules are expressed on antigen presenting cells (including B cells) and a subset of T cells from H-2b,d,q,r bearing mice and are involved in antigen presentation to T cells expressing CD3/TCR and CD4 proteins.

PPARg: transcription factor driving expression of many AM-specific genes

Chil3: robustly expressed in mouse alveolar macrophage thought to function as a lectin and may be involved in inflammation and allergy.

Fabp5: FABP5 programs lipid metabolism to regulate M2 polarization

Flt1: VEGFR family member with antiangiogenic capacity

labels subset of macrophages in breast cancer (human and mouse) enriched in metastatic sites

Fabp4: expressed in resident alveolar macrophages FABP4+macrophages play an important role in infection. (https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6988858/) https://link.springer.com/article/10.1007/s13402-023-00816-7

EAR1: predominantly expressed in lungs of naive mice The expression of Ear genes in the mouse is confined to sites of known eosinophilopoiesis, with the exception of the lung. Two Ear genes, Ear1 and Ear2, are predominantly expressed in the lungs of naive mice. Total Ear gene expression and RNase activity in bronchoalveolar lavage fluid increases significantly upon the induction of pulmonary inflammation using an ovalbumin (OVA) model of allergic sensitization and challenge. Interestingly, pulmonary Ear11 transcripts, which are absent in naive mice, accumulate as a consequence of OVA-mediated T(H)2 inflammation in the lung.

Krt79: robustly expressed in mouse alveolar macrophage

load in the required packages and the central object the central object is the starting off point for all future analyses

```{r Load in data and the required packages}
easypackages::libraries("viridis","patchwork", "Seurat", "tidyverse","tidyseurat")
obj.v5 <- read_rds("../../Documents/machiels_lab_viral/intermediate_data/seurat_obj_central.rds")
DefaultAssay(obj.v5) <- "adt"

```

dsb: denoised scaled by background normalization takes the raw expression matrix from the ab seq experiment as input identifies empty droplets or those with minimal protein content (background signal) normalizes the expression values in each cell by accounting fo technical variations and removing the afore mentioned background signal

in this analysis the Z-score is used to denote protein expression, the Z-score describes a value's relation to the mean of the dataset by giving the amount of standard deviations the specific point (value) is removed from the average.

The Z-score would be one of the appropriate metrics to denote expression of the marker genes

In this case, it tells how many the average expression level of a particular gene is away from the overall mean expression of that gene across all samples.

Positive Z score indicates that the average expression of that gene in that sample is higher than the overall average expression of that gene across all samples. Hence it can be said with a level of caution that the gene is relatively overexpressed in this sample compared to the overall mean exprression of it.

Negative Z score indicates that the average expression of that gene in that sample is lowerthan the overall average expression of that gene across all samples. Hence it can be said with a level of caution that the gene is relatively underexpressed in this sample compared to the overall mean exprression of it.

```{r}
obj.v5 |>
  join_features(c("Siglecf-AbSeq", "H2-ia-ie-AbSeq", "Cd274-AbSeq", "Cd11c", "Ly-6g-AbSeq", "Ly-6a-AbSeq"
                  ),assay="adt", slot="scale.data")  |> 
group_by(.feature,harmony_cluster_8dims_rough) |>
  summarise(mean_scaled_dsb=mean(.abundance_adt)) |>
  group_by(.feature) |> 
  mutate(zscore_mean_scaled_dsb=(mean_scaled_dsb-mean(mean_scaled_dsb))/sd(mean_scaled_dsb))|> na.omit() |> 
  mutate(zscore_mean_scaled_dsb=ifelse(zscore_mean_scaled_dsb>2,2,
                                       ifelse(zscore_mean_scaled_dsb<(-2),-2,zscore_mean_scaled_dsb))) |> 
  ggplot(aes(.feature,harmony_cluster_8dims_rough, fill=zscore_mean_scaled_dsb)) +
  geom_tile()+ scale_fill_viridis() + theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) +ggtitle("mean dsb-normalized protein counts, z-score of cluster averages per marker")
ggsave(filename = "heatmap_markers_abseq_per_sample.png", width = 30, height = 45, units = "cm")
```

\

```{r}
obj.v5 |>
  join_features(c("Siglecf-AbSeq", "H2-ia-ie-AbSeq", "Cd274-AbSeq", "Cd11c", "Ly-6g-AbSeq", "Ly-6a-AbSeq"
                  ),assay="adt", slot="scale.data")  |> 
group_by(.feature,harmony_cluster_8dims_rough) |>
  summarise(mean_scaled_dsb=mean(.abundance_adt))  |> 
  ggplot(aes(.feature,harmony_cluster_8dims_rough, fill=
mean_scaled_dsb)) +
  geom_tile()+ scale_fill_viridis() + theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) +ggtitle("mean dsb-normalized and max scaled per batch protein expression")
ggsave("heatmap_markersAbseq_cluster.png", path = "output/abseq")
```

```{r}
DimPlot(obj.v5, reduction = "umap.harmony_8dims", split.by = "day")
```

```{r}
ggsave(filename = "umap_centralObject_splitByExperiment.png", path = "output/plotsUmap/")

```

```{r}
obj.v5 |>
  join_features(c("Siglecf-AbSeq", "H2-ia-ie-AbSeq", "Cd274-AbSeq", "Cd11c", "Ly-6g-AbSeq", "Ly-6a-AbSeq"
                  ),assay="adt", slot="scale.data")  |> 
group_by(.feature,harmony_cluster_8dims_rough) |>
  summarise(mean_scaled_dsb=mean(.abundance_adt)) |>
  group_by(.feature) |> 
  mutate(zscore_mean_scaled_dsb=(mean_scaled_dsb-mean(mean_scaled_dsb))/sd(mean_scaled_dsb))|> na.omit() |> 
  mutate(zscore_mean_scaled_dsb=ifelse(zscore_mean_scaled_dsb>2,2,
                                       ifelse(zscore_mean_scaled_dsb<(-2),-2,zscore_mean_scaled_dsb))) |> 
  ggplot(aes(.feature,harmony_cluster_8dims_rough, fill=zscore_mean_scaled_dsb)) +
  geom_tile()+ scale_fill_viridis() + theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) +ggtitle("mean dsb-normalized protein counts, z-score of cluster averages per marker")
```

```{r}
ggsave("heatmap_markersAbseq_cluster_zscore_clusteraverages.png", path = "output/abseq")
```

```{r}
obj.v5 |>
  join_features(c("Siglecf-AbSeq", "H2-ia-ie-AbSeq", "Cd274-AbSeq", "Cd11c", "Ly-6g-AbSeq", "Ly-6a-AbSeq"
                  ),assay="adt", slot="scale.data")  |> 
group_by(.feature,harmony_cluster_8dims_rough) |>
  summarise(mean_scaled_dsb=mean(.abundance_adt))  |> 
  ggplot(aes(.feature,harmony_cluster_8dims_rough, fill=
mean_scaled_dsb)) +
  geom_tile()+ scale_fill_viridis() + theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) +ggtitle("mean dsb-normalized and max scaled per batch protein expression")
```

```{r}
ggsave("heatmap_markersAbseq_cluster.png", path = "output/abseq")
```

## General UMAP plots

```{r}
featureplot_siglecf = FeaturePlot(obj.v5, features = c("Siglecf-AbSeq"), reduction = "umap.harmony_8dims", label = T, cols = c("green", "red")) & theme(legend.position = "right")
featureplot_siglecf
ggsave(filename = "featureplot_siglecf.png", width = 45, height = 45, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/")

```

```{r}
featureplot_H2_ia_ie = FeaturePlot(obj.v5, features = c( "H2-ia-ie-AbSeq"), reduction = "umap.harmony_8dims", label = T, cols = c("green", "red")) & theme(legend.position = "right")
featureplot_H2_ia_ie
ggsave(filename = "featureplot_h2.png", width = 45, height = 45, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/")
```

```{r}
featureplot_CD274 = FeaturePlot(obj.v5, features = c("Cd274-AbSeq"), reduction = "umap.harmony_8dims", label = T, 
                                  cols = c("green", "red")) & theme(legend.position = "right")
featureplot_CD274
ggsave(filename = "featureplot_cd274.png", width = 45, height = 45, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/")
```

```         
```

```{r}
featureplot_CD11c = FeaturePlot(obj.v5, features = c("Cd11c"), reduction = "umap.harmony_8dims", label = T, 
                                  cols = c("green", "red")) & theme(legend.position = "right")
featureplot_CD11c
ggsave(filename = "featureplot_cd11c.png", width = 45, height = 45, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/")
```

## UMAP plots d8: effect of tissue

```{r}
seurat_onlyd8 <- obj.v5 %>% filter(str_detect(day_factor, "d8")) 
seurat_onlyd8 <- seurat_onlyd8 %>%filter(!str_detect(condition, "Mock"))
seurat_onlyd8 %>% write_rds("../../Documents/machiels_lab_viral/intermediate_data/seurat_obj_central_d8") 
clustersAlveolar = c(0, 2, 4, 6, 7, 8)
# seurat_onlyd8_alveolarClusters <- seurat_onlyd8 %>% subset(seurat_onlyd8$harmony_cluster_8dims, subset = c(0, 2, 4, 6, 7, 8)) 
featureplot_d8_tissue_cd274 = FeaturePlot(seurat_onlyd8, features = c("Cd274-AbSeq"), reduction = "umap.harmony_8dims", label = T, split.by = "sample_type", cols = c("green", "red")) & theme(legend.position = "right")
featureplot_d8_tissue_cd274
ggsave(filename = "featureplot_d8_tissue_cd274.png", width = 45, height = 45, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/d8/tissue")
```

```{r}
featureplot_d8_tissue_cd11c = FeaturePlot(seurat_onlyd8, features = c("Cd11c"), reduction = "umap.harmony_8dims", label = T, label.size =  , split.by = "sample_type", cols = c("green", "red")) & theme(legend.position = "right")
featureplot_d8_tissue_cd11c
ggsave(filename = "featureplot_d8_tissue_cd11c.png", width = 45, height = 45, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/d8/tissue")
```

```{r}
featureplot_d8_tissue_h2 = FeaturePlot(seurat_onlyd8, features = c("H2-ia-ie-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size =  , split.by = "sample_type", cols = c("green", "red")) & theme(legend.position = "right")
featureplot_d8_tissue_h2
ggsave(filename = "featureplot_d8_tissue_h2.png", width = 45, height = 45, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/d8/tissue")
```

```{r}

```

```{r}
featureplot_d8_tissue_SiglecF = FeaturePlot(seurat_onlyd8, features = c("Siglecf-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size =  , split.by = "sample_type", cols = c("green", "red")) & theme(legend.position = "right")
featureplot_d8_tissue_SiglecF
ggsave(filename = "featureplot_d8_tissue_SiglecF.png", width = 45, height = 45, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/d8/tissue")
```

## UMAP plots d8: effect of virus

```{r}
featureplot_d8_virus_SiglecF = FeaturePlot(seurat_onlyd8, features = c("Siglecf-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size = 8 , split.by = "virus", cols = c("green", "red")) & theme(legend.position = "right")
featureplot_d8_virus_SiglecF
ggsave(filename = "featureplot_d8_virus_siglecf.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/d8/virus") 
```

```{r}
featureplot_d8_virus_cd274 = FeaturePlot(seurat_onlyd8, features = c("Cd274-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size = 8 , split.by = "virus", cols = c("green", "red")) & theme(legend.position = "right")
featureplot_d8_virus_cd274
ggsave(filename = "featureplot_d8_virus_cd274.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/d8/virus") 
```

```{r}
featureplot_d8_virus_h2 = FeaturePlot(seurat_onlyd8, features = c("H2-ia-ie-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size = 8 , split.by = "virus", cols = c("green", "red")) & theme(legend.position = "right")
featureplot_d8_virus_h2
ggsave(filename = "featureplot_d8_virus_h2.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/d8/virus") 
```

```{r}
featureplot_d8_virus_cd11c = FeaturePlot(seurat_onlyd8, features = c("Cd11c"), reduction = "umap.harmony_8dims", label = T, label.size = 8 , split.by = "virus", cols = c("green", "red")) & theme(legend.position = "right")
featureplot_d8_virus_cd11c
ggsave(filename = "featureplot_d8_virus_cd11c.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/d8/virus") 
```

## UMAP plots d60: effect of tissue

```{r}
seurat_onlyd60 <- obj.v5 %>% filter(str_detect(day_factor, "d60")) 
seurat_onlyd60 <- seurat_onlyd60 %>%filter(!str_detect(condition, "Mock"))
seurat_onlyd60 %>% write_rds("../../Documents/machiels_lab_viral/intermediate_data/seurat_obj_central_d8") 
clustersAlveolar = c(0, 2, 4, 6, 7, 8)
# seurat_onlyd8_alveolarClusters <- seurat_onlyd8 %>% subset(seurat_onlyd8$harmony_cluster_8dims, subset = c(0, 2, 4, 6, 7, 8)) 
featureplot_d60_tissue_cd274 = FeaturePlot(seurat_onlyd60, features = c("Cd274-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size =  , split.by = "sample_type", cols = c("green", "red")) & theme(legend.position = "right")
featureplot_d60_tissue_cd274
ggsave(filename = "featureplot_d60_tissue_cd274.png", width = 45, height = 45, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/d60/tissue")
```

```{r}
featureplot_d60_tissue_cd11c = FeaturePlot(seurat_onlyd60, features = c("Cd11c"), reduction = "umap.harmony_8dims", label = T, label.size =  , split.by = "sample_type", cols = c("green", "red")) & theme(legend.position = "right")
featureplot_d60_tissue_cd11c
ggsave(filename = "featureplot_d60_tissue_cd11c.png", width = 45, height = 45, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/d60/tissue")
```

```{r}
featureplot_d60_tissue_h2 = FeaturePlot(seurat_onlyd60, features = c("H2-ia-ie-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size =  , split.by = "sample_type", cols = c("green", "red")) & theme(legend.position = "right") 
featureplot_d60_tissue_h2
ggsave(filename = "featureplot_d60_tissue_h2.png", width = 45, height = 45, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/d60/tissue")
```

```{r}
featureplot_d60_tissue_SiglecF = FeaturePlot(seurat_onlyd60, features = c("Siglecf-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size =  , split.by = "sample_type", cols = c("green", "red")) & theme(legend.position = "right")
featureplot_d60_tissue_SiglecF
ggsave(filename = "featureplot_d60_tissue_SiglecF.png", width = 45, height = 45, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/d60/tissue")
```

## UMAP plots d60: effect of virus

```{r}
featureplot_d60_virus_SiglecF = FeaturePlot(seurat_onlyd60, features = c("Siglecf-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size = 8 , split.by = "virus", cols = c("green", "red"))& theme(legend.position = "right")
featureplot_d60_virus_SiglecF
ggsave(filename = "featureplot_d60_virus_siglecf.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/d60/virus") 
```

```{r}
featureplot_d60_virus_cd274 = FeaturePlot(seurat_onlyd60, features = c("Cd274-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size = 8 , split.by = "virus", cols = c("green", "red")) & theme(legend.position = "right")
featureplot_d60_virus_cd274
ggsave(filename = "featureplot_d60_virus_cd274.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/d60/virus") 
```

```{r}
featureplot_d60_virus_h2 = FeaturePlot(seurat_onlyd60, features = c("H2-ia-ie-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size = 8 , split.by = "virus", cols = c("green", "red")) & theme(legend.position = "right")
featureplot_d60_virus_h2
ggsave(filename = "featureplot_d60_virus_h2.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/d60/virus") 
```

```{r}
featureplot_d60_virus_cd11c = FeaturePlot(seurat_onlyd60, features = c("Cd11c"), reduction = "umap.harmony_8dims", label = T, label.size = 8 , split.by = "virus", cols = c("green", "red")) & theme(legend.position = "right")
featureplot_d60_virus_cd11c
ggsave(filename = "featureplot_d60_virus_cd11c.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/d60/virus") 
```

## UMAP plots different days

```{r}
seurat_noMock <- obj.v5 %>%filter(!str_detect(condition, "Mock"))
featureplot_days_cd11c = FeaturePlot(seurat_noMock,features = c("Cd11c"), reduction = "umap.harmony_8dims", label = T, label.size = 8 , split.by = "day_factor", cols = c("green", "red")) & theme(legend.position = "right")
featureplot_days_cd11c
ggsave(filename = "featureplot_d60_virus_cd11c.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/mock/days") 
```

```{r}
featureplot_days_h2 = FeaturePlot(seurat_noMock,features = c("H2-ia-ie-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size = 8 , split.by = "day_factor", cols = c("green", "red")) & theme(legend.position = "right")
featureplot_days_h2
ggsave(filename = "featureplot_d60_virus_h2.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/mock/days") 
```

```{r}
featureplot_days_Cd274 = FeaturePlot(seurat_noMock,features = c("Cd274-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size = 8 , split.by = "day_factor", cols = c("green", "red")) & theme(legend.position = "right")
featureplot_days_Cd274
ggsave(filename = "featureplot_d60_virus_Cd274.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/mock/days") 
```

```{r}
featureplot_days_siglecf = FeaturePlot(seurat_noMock,features = c("Siglecf-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size = 8 , split.by = "day_factor", cols = c("green", "red")) & theme(legend.position = "right")
featureplot_days_siglecf
ggsave(filename = "featureplot_d60_virus_siglecf.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/mock/days") 
```

## UMAP plots mock tissue

```{r}
seurat_Mock <- obj.v5 %>%filter(str_detect(condition, "Mock"))
featureplot_mock_tissue_cd11c = FeaturePlot(seurat_noMock,features = c("Cd11c"), reduction = "umap.harmony_8dims", label = T, label.size = 8 , split.by = "sample_type", cols = c("green", "red")) & theme(legend.position = "right")
featureplot_mock_tissue_cd11c
ggsave(filename = "featureplot_mock_tissue_cd11c.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/mock/tissue") 
```

```{r}
featureplot_mock_tissue_cd274 = FeaturePlot(seurat_noMock,features = c("Cd274-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size = 8 , split.by = "sample_type", cols = c("green", "red")) & theme(legend.position = "right")
featureplot_mock_tissue_cd274
ggsave(filename = "featureplot_mock_tissue_cd274.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/mock/tissue") 
```

```{r}
featureplot_mock_tissue_Siglecf = FeaturePlot(seurat_noMock,features = c("Siglecf-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size = 8 , split.by = "sample_type", cols = c("green", "red")) & theme(legend.position = "right")
featureplot_mock_tissue_Siglecf
ggsave(filename = "featureplot_mock_tissue_Siglecf.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/mock/tissue") 
```

```{r}
featureplot_mock_tissue_h2 = FeaturePlot(seurat_noMock,features = c("H2-ia-ie-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size = 8 , split.by = "sample_type", cols = c("green", "red")) & theme(legend.position = "right")
featureplot_mock_tissue_h2
ggsave(filename = "featureplot_mock_tissue_h2.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/mock/tissue") 
```

## UMAP plots mock d8 d60

day_mock reflects the original day information but assigns `"Mock"` for rows where the experimental condition was actually a mock.

```{r}
featureplot_all_times_cd11c = FeaturePlot(obj.v5, features = c("Cd11c"), reduction = "umap.harmony_8dims", label = T, label.size =  , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_cd11c
ggsave(filename = "featureplot_all_times_cd11c.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes")
```

```{r}
featureplot_all_times_h2 = FeaturePlot(obj.v5, features = c("H2-ia-ie-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size =  , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_h2
ggsave(filename = "featureplot_all_times_h2.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes")
```

```{r}
featureplot_all_times_siglecf = FeaturePlot(obj.v5, features = c("Siglecf-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size =  , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_siglecf
ggsave(filename = "featureplot_all_times_siglecf.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes")
```

```{r}
featureplot_all_times_cd274 = FeaturePlot(obj.v5, features = c("Cd274-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size =  , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_cd274
ggsave(filename = "featureplot_all_times_cd274.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes")
```

```{r}
featureplot_all_times_pparg = FeaturePlot(obj.v5, features = c("Pparg"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_pparg
ggsave(filename = "featureplot_all_times_pparg.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes")
```

## UMAP plots mock d8 d60 lung

```{r}
seurat_onlyLung <- obj.v5 %>% filter(str_detect(sample_type, "lung")) 
featureplot_all_times_lung_pparg = FeaturePlot(seurat_onlyLung, features = c("Pparg"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_lung_pparg
ggsave(filename = "featureplot_all_times_lung_pparg.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/lung")
```

```{r}
featureplot_all_times_lung_Cd11c = FeaturePlot(seurat_onlyLung, features = c("Cd11c"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_lung_Cd11c 
ggsave(filename = "featureplot_all_times_lung_cd11c.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/lung")
```

```{r}
featureplot_all_times_lung_siglecf = FeaturePlot(seurat_onlyLung, features = c("Siglecf-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_lung_siglecf
ggsave(filename = "featureplot_all_times_lung_siglecf.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/lung")
```

```{r}
featureplot_all_times_lung_h2 = FeaturePlot(seurat_onlyLung, features = c("H2-ia-ie-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_lung_h2
ggsave(filename = "featureplot_all_times_lung_h2.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/lung")
```

```{r}
featureplot_all_times_lung_cd274 = FeaturePlot(seurat_onlyLung, features = c("Cd274-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_lung_cd274
ggsave(filename = "featureplot_all_times_lung_cd274.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/lung")
```

## UMAP plots mock d8 d60 bal

```{r}
seurat_onlyBAL <- obj.v5 %>% filter(str_detect(sample_type, "bal")) 
featureplot_all_times_bal_pparg = FeaturePlot(seurat_onlyBAL, features = c("Pparg"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_bal_pparg
ggsave(filename = "featureplot_all_times_bal_pparg.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/bal")
```

```{r}
featureplot_all_times_bal_cd11c = FeaturePlot(seurat_onlyBAL, features = c("Cd11c"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_bal_cd11c
ggsave(filename = "featureplot_all_times_bal_cd11c.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/bal")
```

```{r}
featureplot_all_times_bal_h2 = FeaturePlot(seurat_onlyBAL, features = c("H2-ia-ie-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_bal_h2
ggsave(filename = "featureplot_all_times_bal_h2.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/bal")
```

```{r}
featureplot_all_times_bal_siglec = FeaturePlot(seurat_onlyBAL, features = c("Siglecf-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_bal_siglec
ggsave(filename = "featureplot_all_times_bal_siglec.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/bal")
```

```{r}
featureplot_all_times_bal_cd274 = FeaturePlot(seurat_onlyBAL, features = c("Cd274-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_bal_cd274
ggsave(filename = "featureplot_all_times_bal_cd274.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/bal")
```

## UMAP plots mock d8 d60 muhv4

```{r}
seurat_onlymuhv4 <- obj.v5 %>% filter(str_detect(condition, "MuHV4")) 
seurat_onlymuhv4 <- seurat_onlymuhv4 %>%filter(!str_detect(condition, "Mock"))
featureplot_all_times_muhv4_h2 = FeaturePlot(seurat_onlymuhv4, features = c("H2-ia-ie-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_muhv4_h2
ggsave(filename = "featureplot_all_times_muhv4_h2.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/muhv4")
```

```{r}
featureplot_all_times_muhv4_siglec = FeaturePlot(seurat_onlymuhv4, features = c("Siglecf-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_muhv4_siglec
ggsave(filename = "featureplot_all_times_muhv4_siglec.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/muhv4")
```

```{r}
featureplot_all_times_muhv4_cd274 = FeaturePlot(seurat_onlymuhv4, features = c("Cd274-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_muhv4_cd274
ggsave(filename = "featureplot_all_times_muhv4_cd274.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/muhv4")
```

```{r}
featureplot_all_times_muhv4_cd11c = FeaturePlot(seurat_onlymuhv4, features = c("Cd11c"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_muhv4_cd11c
ggsave(filename = "featureplot_all_times_muhv4_cd11c.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/muhv4")
```

```{r}
featureplot_all_times_muhv4_pparg = FeaturePlot(seurat_onlymuhv4, features = c("Pparg"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_muhv4_pparg
ggsave(filename = "featureplot_all_times_muhv4_pparg.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/muhv4")
```

## UMAP plots mock d8 d60 MAV1

```{r}
seurat_onlyMAV1 <- obj.v5 %>% filter(str_detect(condition, "MAV1")) 
seurat_onlyMAV1 <- seurat_onlyMAV1 %>%filter(!str_detect(condition, "Mock"))
featureplot_all_times_MAV1_h2 = FeaturePlot(seurat_onlyMAV1, features = c("H2-ia-ie-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_MAV1_h2
ggsave(filename = "featureplot_all_times_MAV1_h2.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/MAV1")
```

```{r}
featureplot_all_times_MAV1_siglec = FeaturePlot(seurat_onlyMAV1, features = c("Siglecf-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_MAV1_siglec
ggsave(filename = "featureplot_all_times_MAV1_siglec.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/MAV1")
```

```{r}
featureplot_all_times_MAV1_cd274 = FeaturePlot(seurat_onlyMAV1, features = c("Cd274-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_MAV1_cd274
ggsave(filename = "featureplot_all_times_MAV1_cd274.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/MAV1")
```

```{r}
featureplot_all_times_MAV1_cd11c = FeaturePlot(seurat_onlyMAV1, features = c("Cd11c"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_MAV1_cd11c
ggsave(filename = "featureplot_all_times_MAV1_cd11c.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/MAV1")
```

```{r}
featureplot_all_times_MAV1_pparg = FeaturePlot(seurat_onlyMAV1, features = c("Pparg"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_MAV1_pparg
ggsave(filename = "featureplot_all_times_MAV1_pparg.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/MAV1")
```

## UMAP plots mock d8 d60 PVM

```{r}
seurat_onlyPVM <- obj.v5 %>% filter(str_detect(condition, "PVM")) 
seurat_onlyPVM <- seurat_onlyPVM %>%filter(!str_detect(condition, "Mock"))
featureplot_all_times_PVM_h2 = FeaturePlot(seurat_onlyPVM, features = c("H2-ia-ie-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_PVM_h2
ggsave(filename = "featureplot_all_times_PVM_h2.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/PVM")
```

```{r}
featureplot_all_times_PVM_siglec = FeaturePlot(seurat_onlyPVM, features = c("Siglecf-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_PVM_siglec
ggsave(filename = "featureplot_all_times_PVM_siglec.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/PVM")
```

```{r}
featureplot_all_times_PVM_cd274 = FeaturePlot(seurat_onlyPVM, features = c("Cd274-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_PVM_cd274
ggsave(filename = "featureplot_all_times_PVM_cd274.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/PVM")
```

```{r}
featureplot_all_times_PVM_cd11c = FeaturePlot(seurat_onlyPVM, features = c("Cd11c"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_PVM_cd11c
ggsave(filename = "featureplot_all_times_PVM_cd11c.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/PVM")
```

```{r}
featureplot_all_times_PVM_pparg = FeaturePlot(seurat_onlyPVM, features = c("Pparg"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_PVM_pparg
ggsave(filename = "featureplot_all_times_PVM_pparg.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/PVM")
```

## UMAP plots mock d8 d60 PR8

```{r}
seurat_onlyPR8 <- obj.v5 %>% filter(str_detect(condition, "PR8")) 
seurat_onlyPR8 <- seurat_onlyPR8 %>%filter(!str_detect(condition, "Mock"))
featureplot_all_times_PR8_h2 = FeaturePlot(seurat_onlyPR8, features = c("H2-ia-ie-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_PR8_h2
ggsave(filename = "featureplot_all_times_PR8_h2.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/PR8")
```

```{r}
featureplot_all_times_PR8_siglec = FeaturePlot(seurat_onlyPR8, features = c("Siglecf-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_PR8_siglec
ggsave(filename = "featureplot_all_times_PR8_siglec.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/PR8")
```

```{r}
featureplot_all_times_PR8_cd274 = FeaturePlot(seurat_onlyPR8, features = c("Cd274-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_PR8_cd274
ggsave(filename = "featureplot_all_times_PR8_cd274.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/PR8")
```

```{r}
featureplot_all_times_PR8_cd274 = FeaturePlot(seurat_onlyPR8, features = c("Cd274-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_PR8_cd274
ggsave(filename = "featureplot_all_times_PR8_cd274.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/PR8")
```

```{r}
featureplot_all_times_PR8_cd11c = FeaturePlot(seurat_onlyPR8, features = c("Cd11c"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_PR8_cd11c
ggsave(filename = "featureplot_all_times_PR8_cd11c.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/PR8")
```

```{r}
featureplot_all_times_PR8_cd11c1 = FeaturePlot(seurat_onlyPR8, features = c("Cd11c"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right", )
featureplot_all_times_PR8_cd11c1
ggsave(filename = "featureplot_all_times_PR8_cd11c1.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/PR8")
```

```{r}
featureplot_all_times_PR8_pparg = FeaturePlot(seurat_onlyPR8, features = c("Pparg"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_PR8_pparg
ggsave(filename = "featureplot_all_times_PR8_pparg.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/PR8")
```

## UMAP plots mock d8 d60 PR8 lung

```{r}
seurat_onlyPR8_lung <- seurat_onlyPR8 %>%filter(!str_detect(sample_type, "lung"))
featureplot_all_times_PR8_lung_h2 = FeaturePlot(seurat_onlyPR8, features = c("H2-ia-ie-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_PR8_lung_h2
ggsave(filename = "featureplot_all_times_PR8_lung_h2.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/PR8/lung")
```

```{r}
featureplot_all_times_PR8_lung_siglec = FeaturePlot(seurat_onlyPR8, features = c("Siglecf-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_PR8_lung_siglec
ggsave(filename = "featureplot_all_times_PR8_lung_siglec.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/PR8/lung")
```

```{r}
featureplot_all_times_PR8_lung_cd274 = FeaturePlot(seurat_onlyPR8, features = c("Cd274-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_PR8_lung_cd274
ggsave(filename = "featureplot_all_times_PR8_lung_cd274.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/PR8/lung")
```

```{r}
featureplot_all_times_PR8_lung_cd11c = FeaturePlot(seurat_onlyPR8, features = c("Cd11c"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_PR8_lung_cd11c
ggsave(filename = "featureplot_all_times_PR8_lung_cd11c.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/PR8/lung")
```

```{r}
featureplot_all_times_PR8_lung_pparg = FeaturePlot(seurat_onlyPR8, features = c("Pparg"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_PR8_lung_pparg
ggsave(filename = "featureplot_all_times_PR8_lung_pparg.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/PR8/lung")
```

## UMAP plots mock d8 d60 PR8 bal

```{r}
seurat_onlyPR8_bal <- seurat_onlyPR8 %>%filter(!str_detect(sample_type, "bal"))
featureplot_all_times_PR8_bal_h2 = FeaturePlot(seurat_onlyPR8, features = c("H2-ia-ie-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_PR8_bal_h2
ggsave(filename = "featureplot_all_times_PR8_bal_h2.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/PR8/bal")
```

```{r}
featureplot_all_times_PR8_bal_siglec = FeaturePlot(seurat_onlyPR8, features = c("Siglecf-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_PR8_bal_siglec
ggsave(filename = "featureplot_all_times_PR8_bal_siglec.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/PR8/bal")
```

```{r}
featureplot_all_times_PR8_bal_cd274 = FeaturePlot(seurat_onlyPR8, features = c("Cd274-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_PR8_bal_cd274
ggsave(filename = "featureplot_all_times_PR8_bal_cd274.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/PR8/bal")
```

```{r}
featureplot_all_times_PR8_bal_cd11c = FeaturePlot(seurat_onlyPR8, features = c("Cd11c"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_PR8_bal_cd11c
ggsave(filename = "featureplot_all_times_PR8_bal_cd11c.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/PR8/bal")
```

```{r}
featureplot_all_times_PR8_bal_pparg = FeaturePlot(seurat_onlyPR8, features = c("Pparg"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_PR8_bal_pparg
ggsave(filename = "featureplot_all_times_PR8_bal_pparg.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/PR8/bal")
```

## UMAP plots mock d8 d60 MuHv4 bal

```{r}
seurat_onlymuhv4_bal <- seurat_onlymuhv4 %>%filter(!str_detect(sample_type, "bal"))
featureplot_all_times_muhv4_bal_h2 = FeaturePlot(seurat_onlymuhv4_bal, features = c("H2-ia-ie-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_muhv4_bal_h2
ggsave(filename = "featureplot_all_times_MuHV4_bal_h2.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/MuHV4/bal")
```

```{r}
featureplot_all_times_muhv4_bal_siglec = FeaturePlot(seurat_onlymuhv4_bal, features = c("Siglecf-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_muhv4_bal_siglec
ggsave(filename = "featureplot_all_times_MuHV4_bal_siglec.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/MuHV4/bal")
```

```{r}
featureplot_all_times_muhv4_bal_cd274 = FeaturePlot(seurat_onlymuhv4_bal, features = c("Cd274-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_muhv4_bal_cd274
ggsave(filename = "featureplot_all_times_MuHV4_bal_cd274.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/MuHV4/bal")
```

```{r}
featureplot_all_times_muhv4_bal_cd11c = FeaturePlot(seurat_onlymuhv4_bal, features = c("Cd11c"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_muhv4_bal_cd11c
ggsave(filename = "featureplot_all_times_MuHV4_bal_cd11c.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/MuHV4/bal")
```

```{r}
featureplot_all_times_muhv4_bal_pparg = FeaturePlot(seurat_onlymuhv4_bal, features = c("Pparg"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_muhv4_bal_pparg
ggsave(filename = "featureplot_all_times_MuHV4_bal_pparg.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/MuHV4/bal")
```

## UMAP plots mock d8 d60 MuHv4 lung

```{r}
seurat_onlymuhv4_lung <- seurat_onlymuhv4 %>%filter(!str_detect(sample_type, "lung"))
featureplot_all_times_muhv4_lung_h2 = FeaturePlot(seurat_onlymuhv4_lung, features = c("H2-ia-ie-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_muhv4_lung_h2
ggsave(filename = "featureplot_all_times_MuHV4_lung_h2.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/MuHV4/lung")
```

```{r}
featureplot_all_times_muhv4_lung_siglec = FeaturePlot(seurat_onlymuhv4_lung, features = c("Siglecf-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_muhv4_lung_siglec
ggsave(filename = "featureplot_all_times_MuHV4_lung_siglec.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/MuHV4/lung")
```

```{r}
featureplot_all_times_muhv4_lung_cd274 = FeaturePlot(seurat_onlymuhv4_lung, features = c("Cd274-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_muhv4_lung_cd274
ggsave(filename = "featureplot_all_times_MuHV4_lung_cd274.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/MuHV4/lung")
```

```{r}
featureplot_all_times_muhv4_lung_cd11c = FeaturePlot(seurat_onlymuhv4_lung, features = c("Cd11c"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_muhv4_lung_cd11c
ggsave(filename = "featureplot_all_times_MuHV4_lung_cd11c.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/MuHV4/lung")
```

```{r}
featureplot_all_times_muhv4_lung_pparg = FeaturePlot(seurat_onlymuhv4_lung, features = c("Pparg"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_muhv4_lung_pparg
ggsave(filename = "featureplot_all_times_MuHV4_lung_pparg.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/MuHV4/lung")
```

## UMAP plots mock d8 d60 MAV1 lung

```{r}
seurat_onlyMAV1_lung <- seurat_onlyMAV1 %>%filter(!str_detect(sample_type, "lung"))
featureplot_all_times_MAV1_lung_h2 = FeaturePlot(seurat_onlyMAV1_lung, features = c("H2-ia-ie-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_MAV1_lung_h2
ggsave(filename = "featureplot_all_times_MAV1_lung_h2.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/MAV1/lung")
```

```{r}
featureplot_all_times_MAV1_lung_siglec = FeaturePlot(seurat_onlyMAV1_lung, features = c("Siglecf-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_MAV1_lung_siglec
ggsave(filename = "featureplot_all_times_MAV1_lung_siglec.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/MAV1/lung")
```

```{r}
featureplot_all_times_MAV1_lung_cd274 = FeaturePlot(seurat_onlyMAV1_lung, features = c("Cd274-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_MAV1_lung_cd274
ggsave(filename = "featureplot_all_times_MAV1_lung_cd274.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/MAV1/lung")
```

```{r}
featureplot_all_times_MAV1_lung_cd11c = FeaturePlot(seurat_onlyMAV1_lung, features = c("Cd11c"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_MAV1_lung_cd11c
ggsave(filename = "featureplot_all_times_MAV1_lung_cd11c.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/MAV1/lung")
```

```{r}
featureplot_all_times_MAV1_lung_pparg = FeaturePlot(seurat_onlyMAV1_lung, features = c("Pparg"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_MAV1_lung_pparg
ggsave(filename = "featureplot_all_times_MAV1_lung_pparg.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/MAV1/lung")
```

## UMAP plots mock d8 d60 MAV1 bal

```{r}
seurat_onlyMAV1_bal <- seurat_onlyMAV1 %>%filter(!str_detect(sample_type, "bal"))
featureplot_all_times_MAV1_bal_h2 = FeaturePlot(seurat_onlyMAV1_bal, features = c("H2-ia-ie-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_MAV1_bal_h2
ggsave(filename = "featureplot_all_times_MAV1_bal_h2.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/MAV1/bal")
```

```{r}
featureplot_all_times_MAV1_bal_siglec = FeaturePlot(seurat_onlyMAV1_bal, features = c("Siglecf-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_MAV1_bal_siglec
ggsave(filename = "featureplot_all_times_MAV1_bal_siglec.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/MAV1/bal")
```

```{r}
featureplot_all_times_MAV1_bal_cd274 = FeaturePlot(seurat_onlyMAV1_bal, features = c("Cd274-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_MAV1_bal_cd274
ggsave(filename = "featureplot_all_times_MAV1_bal_cd274.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/MAV1/bal")
```

```{r}
featureplot_all_times_MAV1_bal_cd11c = FeaturePlot(seurat_onlyMAV1_bal, features = c("Cd11c"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_MAV1_bal_cd11c
ggsave(filename = "featureplot_all_times_MAV1_bal_cd11c.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/MAV1/bal")
```

```{r}
featureplot_all_times_MAV1_bal_pparg = FeaturePlot(seurat_onlyMAV1_bal, features = c("Pparg"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_MAV1_bal_pparg
ggsave(filename = "featureplot_all_times_MAV1_bal_pparg.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/MAV1/bal")
```

## UMAP plots mock d8 d60 PVM bal

```{r}
seurat_onlyPVM_bal <- seurat_onlyPVM %>%filter(!str_detect(sample_type, "bal"))
featureplot_all_times_PVM_bal_h2 = FeaturePlot(seurat_onlyPVM_bal, features = c("H2-ia-ie-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_PVM_bal_h2
ggsave(filename = "featureplot_all_times_PVM_bal_h2.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/PVM/bal")
```

```{r}
featureplot_all_times_PVM_bal_siglec = FeaturePlot(seurat_onlyPVM_bal, features = c("Siglecf-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_PVM_bal_siglec
ggsave(filename = "featureplot_all_times_PVM_bal_siglec.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/PVM/bal")
```

```{r}
featureplot_all_times_PVM_bal_cd11c = FeaturePlot(seurat_onlyPVM_bal, features = c("Cd11c"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_PVM_bal_cd11c
ggsave(filename = "featureplot_all_times_PVM_bal_cd11c.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/PVM/bal")
```

```{r}
featureplot_all_times_PVM_bal_cd274 = FeaturePlot(seurat_onlyPVM_bal, features = c("Cd274-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_PVM_bal_cd274
ggsave(filename = "featureplot_all_times_PVM_bal_cd274.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/PVM/bal")
```

```{r}
featureplot_all_times_PVM_bal_pparg = FeaturePlot(seurat_onlyPVM_bal, features = c("Pparg"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_PVM_bal_pparg
ggsave(filename = "featureplot_all_times_PVM_bal_pparg.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/PVM/bal")
```

## 1UMAP plots mock d8 d60 PVM lung

```{r}
seurat_onlyPVM_lung <- seurat_onlyPVM %>%filter(!str_detect(sample_type, "lung"))
featureplot_all_times_PVM_lung_h2 = FeaturePlot(seurat_onlyPVM_lung, features = c("H2-ia-ie-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_PVM_lung_h2
ggsave(filename = "featureplot_all_times_PVM_lung_h2.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/PVM/lung")
```

```{r}
featureplot_all_times_PVM_lung_siglec = FeaturePlot(seurat_onlyPVM_lung, features = c("Siglecf-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_PVM_lung_siglec
ggsave(filename = "featureplot_all_times_PVM_lung_siglec.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/PVM/lung")
```

```{r}
featureplot_all_times_PVM_lung_cd274 = FeaturePlot(seurat_onlyPVM_lung, features = c("Cd274-AbSeq"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_PVM_lung_cd274
ggsave(filename = "featureplot_all_times_PVM_lung_cd274.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/PVM/lung")
```

```{r}
featureplot_all_times_PVM_lung_cd11c = FeaturePlot(seurat_onlyPVM_lung, features = c("Cd11c"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_PVM_lung_cd11c
ggsave(filename = "featureplot_all_times_PVM_lung_cd11c.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/PVM/lung")
```

```{r}
featureplot_all_times_PVM_lung_pparg = FeaturePlot(seurat_onlyPVM_lung, features = c("Pparg"), reduction = "umap.harmony_8dims", label = T, label.size = , split.by = c("day_mock"), cols = c("green", "red")) & theme(legend.position = "right")
featureplot_all_times_PVM_lung_pparg
ggsave(filename = "featureplot_all_times_PVM_lung_pparg.png", width = 45, height = 20, units = "cm", path = "../../Documents/machiels_lab_viral/output/plotsUmap/alltimes/PVM/lung")
```
